= nested_form_for(@nugget, html: { :role => "form" }) do |f|
  - if @nugget.errors.any?
    #error_explanation.alert.alert-danger
      %h2
        = pluralize(@nugget.errors.count, "error")
        prohibited this nugget from being saved:
      %ul
        - @nugget.errors.full_messages.each do |msg|
          %li= msg

  .row
    .col-lg-12
      .form-group
        = f.text_field :title, class: "form-control", placeholder: "Nugget Title"
  - if params['action'] == 'edit'
    .row
      .col-lg-6
        .form-group
          = f.label :category_id, "Nugget Category"
          = f.collection_select :category_id, Category.all, :id, :indented_title, {include_blank: ''}, class: "form-control"
  - else
    = f.hidden_field :category_id, value: @nugget.category.id

  .row
    .col-lg-12
      .form-group
        = f.label :content, "Content Body"
        = f.text_area :content, class: "form-control"

  .row
    .col-lg-12
      = f.link_to_add "Add Image", :images, class: "btn btn-default"
      = f.fields_for :images do |images_form|
        .well
          .col-lg-2
            %img{src: "/images/#{images_form.object.id}", width: '100px', height: '100px'}

          .col-lg-10
            .form-group
              = f.label :title, 'Image Title'
              = images_form.text_field :title, class: "form-control"

            .form-group
              = f.label :caption, "Image Caption"
              = images_form.text_area :caption, class: "form-control"
              = images_form.file_field :content

          = images_form.link_to_remove "Remove Image"

  .row
    .col-lg-12
      = f.link_to_add 'Add Location', :locations, class: "btn btn-default"
      = f.fields_for :locations do |locations_form|
        .well
          .col-lg-6
            .form-group
              = locations_form.label :address, 'Address'
              = locations_form.text_area :address, class: "form-control"
          .col-lg-6
            .form-group
              = locations_form.label :latitude, 'Latitude'
              = locations_form.text_field :latitude, class: 'form-control'
              = locations_form.label :longitude, 'Longitude'
              = locations_form.text_field :longitude, class: 'form-control'

          = locations_form.link_to_remove "Remove Location"